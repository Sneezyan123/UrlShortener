<header class="header">
  <div class="nav-buttons">
    <button class="btn btn-nav" (click)="navigateToHome()">Home</button>
    <button class="btn btn-nav" (click)="navigateToAbout()">About</button>
  </div>
  <div class="auth-buttons">
    @if (currentUser.isAuthenticated) {
      <span class="welcome-text">Welcome, {{ currentUser.userName }}!</span>
      <button class="btn btn-outline" (click)="onSignOut()">Sign Out</button>
    } @else {
      <button class="btn btn-outline" (click)="onSignIn()">Sign In</button>
      <button class="btn btn-primary" (click)="onSignUp()">Sign Up</button>
    }
  </div>
</header>

<main class="main-content">
  <!-- Success Message -->
  @if (successMessage) {
    <div class="success-message">
      <span>{{ successMessage }}</span>
      <button class="close-btn" (click)="clearSuccess()">Ã—</button>
    </div>
  }

  <!-- Error Message -->
  @if (errorMessage) {
    <div class="error-message">
      <span>{{ errorMessage }}</span>
      <button class="close-btn" (click)="clearError()">Ã—</button>
    </div>
  }

  <!-- URL Input Section -->
  <div class="url-input-container">
    <input 
      type="text" 
      class="url-input" 
      placeholder="Enter your URL here..."
      [(ngModel)]="urlToShorten"
      (keyup.enter)="shortenUrl()"
      [disabled]="isLoading"
    >
    <button 
      class="btn btn-primary" 
      (click)="shortenUrl()"
      [disabled]="isLoading || !urlToShorten.trim() || !currentUser.isAuthenticated"
      [title]="!currentUser.isAuthenticated ? 'Please sign in to shorten URLs' : ''"
    >
      @if (isLoading) {
        <span class="loading-spinner"></span>
      }
      {{ isLoading ? 'Shortening...' : 'Shorten URL' }}
    </button>
  </div>

  <!-- Authentication Notice -->
  @if (!currentUser.isAuthenticated) {
    <div class="auth-notice">
      <p>
        <strong>Sign in required:</strong> 
        You need to <a href="/user/login" class="auth-link">sign in</a> to shorten URLs. 
        Don't have an account? <a href="/user/register" class="auth-link">Register here</a>.
      </p>
    </div>
  }

  <!-- History Section -->
  <section class="history-section">
    <div class="history-header">
      <h2 class="history-title">
        @if (currentUser.isAuthenticated) {
          Your Shortened URLs
        } @else {
          Recently Shortened URLs
        }
      </h2>
      @if (isLoading && !shortenedUrls.length) {
        <div class="loading-indicator">Loading...</div>
      }
    </div>
    
    @if (shortenedUrls.length > 0) {
      <ul class="history-list">
        @for (item of shortenedUrls; track item.id) {
          <li class="history-item">
            <div class="url-info">
              <a [href]="item.originalUrl" class="original-url" target="_blank" rel="noopener noreferrer">
                {{ item.originalUrl }}
              </a>
              <small class="created-date">
                Created: {{ item.createdAt | date:'short' }}
              </small>
            </div>
            <div class="shortened-url-container">
              <a [href]="item.shortUrl" class="shortened-url" target="_blank" rel="noopener noreferrer">
                {{ item.shortUrl }}
              </a>
              <button 
                class="btn btn-copy" 
                (click)="copyToClipboard(item.shortUrl)"
                title="Copy to clipboard"
              >
                ðŸ“‹
              </button>
            </div>
          </li>
        }
      </ul>
    } @else if (!isLoading) {
      <div class="empty-state">
        @if (currentUser.isAuthenticated) {
          <p>No shortened URLs yet. Create your first one above!</p>
        } @else {
          <p>Sign in to see your shortened URLs or view recent public URLs.</p>
        }
      </div>
    }
  </section>
</main>